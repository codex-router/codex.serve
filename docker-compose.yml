services:
  codex-serve:
    image: craftslab/codex-serve:latest
    ports:
      - "8000:8000"
    volumes:
      # Mount the docker socket to allow spawning sibling containers
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      # Tell codex.serve to use the CLI docker image
      - CODEX_DOCKER_IMAGE=craftslab/codex-cli-env:latest
      # Supported CLI providers (comma-separated)
      - CLI_LIST=claude,codex,gemini,opencode,qwen
      # Supported model IDs (comma-separated)
      - MODEL_LIST=ollama-kimi-k2.5,ollama-minimax-m2.5,ollama-qwen3.5
      # LiteLLM endpoint and credentials
      - LITELLM_BASE_URL=${LITELLM_BASE_URL}
      - LITELLM_API_KEY=${LITELLM_API_KEY}
      # /run response timeout in seconds (0 or empty disables timeout)
      - RUN_RESPONSE_TIMEOUT_SECONDS=${RUN_RESPONSE_TIMEOUT_SECONDS:-300}
