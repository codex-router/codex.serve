version: '3.8'

services:
  codex-serve:
    build: .
    ports:
      - "8000:8000"
    volumes:
      # Mount the docker socket to allow spawning sibling containers
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      # Tell codex.serve to use the CLI docker image
      - CODEX_DOCKER_IMAGE=craftslab/codex-cli-env:latest
